[
  {
    "category": "functional",
    "description": "Create useMessageQueue hook for message queue state management",
    "steps": [
      "Create new file src/ui/hooks/use-message-queue.ts",
      "Define QueuedMessage interface with id, content, and queuedAt fields",
      "Define UseMessageQueueReturn interface with queue, enqueue, dequeue, clear, and count",
      "Implement useMessageQueue hook with useState for queue array",
      "Implement enqueue function to add messages with unique id and timestamp",
      "Implement dequeue function to remove and return first message",
      "Implement clear function to empty the queue",
      "Export hook and interfaces",
      "Create tests/ui/hooks/use-message-queue.test.ts with unit tests"
    ],
    "passes": true
  },
  {
    "category": "functional",
    "description": "Integrate message queue into ChatApp to allow input during streaming",
    "steps": [
      "Import useMessageQueue hook into src/ui/chat.tsx",
      "Add queue state using useMessageQueue hook after existing state declarations",
      "Modify handleSubmit to queue messages when isStreaming is true instead of blocking",
      "Clear textarea after enqueue just like after direct send",
      "Verify messages are queued correctly during streaming",
      "Test that input is no longer blocked during streaming responses"
    ],
    "passes": true
  },
  {
    "category": "functional",
    "description": "Process queued messages sequentially after stream completion",
    "steps": [
      "Modify handleComplete in src/ui/chat.tsx to process queue",
      "After setting isStreaming to false, call dequeue to get next message",
      "If message exists, call handleSendMessage with 50ms delay",
      "Verify sequential processing of multiple queued messages",
      "Test queue empties correctly after all messages processed"
    ],
    "passes": true
  },
  {
    "category": "ui",
    "description": "Create QueueIndicator component to display queued message count",
    "steps": [
      "Create new file src/ui/components/queue-indicator.tsx",
      "Define QueueIndicatorProps interface with count and queue array",
      "Render visual indicator showing number of queued messages",
      "Only display when count > 0",
      "Export component from src/ui/components/index.ts",
      "Add unit tests for the component"
    ],
    "passes": true
  },
  {
    "category": "functional",
    "description": "Enhance ToolResult to default collapsed with summary line",
    "steps": [
      "Update src/ui/components/tool-result.tsx to change initialExpanded default to false",
      "Implement getToolSummary function for tool-specific summaries",
      "Handle Read, Glob, Grep, Bash, Edit, Write, and Task tool summaries",
      "Show summary line with tool name and result count when collapsed",
      "Display expand hint text (ctrl+o to expand) when collapsed",
      "Add maxCollapsedLines prop defaulting to 3",
      "Update tests for collapsed default behavior"
    ],
    "passes": true
  },
  {
    "category": "functional",
    "description": "Add verboseMode state to ChatApp",
    "steps": [
      "Add verboseMode state (boolean, default: false) to src/ui/chat.tsx",
      "Pass verboseMode prop to child components that need it",
      "Pass verboseMode to ToolResult components",
      "Pass verboseMode to MessageBubble for timestamp display",
      "Verify state propagates correctly to all child components"
    ],
    "passes": true
  },
  {
    "category": "functional",
    "description": "Implement Ctrl+O keyboard shortcut to toggle verbose mode",
    "steps": [
      "Add keyboard handler for Ctrl+O in src/ui/chat.tsx useKeyboard callback",
      "Toggle verboseMode state when Ctrl+O is pressed",
      "Verify shortcut works in the existing keyboard handling flow",
      "Test that verbose mode toggles correctly on keypress"
    ],
    "passes": true
  },
  {
    "category": "functional",
    "description": "Enhance ToolResult to respect verboseMode prop",
    "steps": [
      "Add verboseMode prop to ToolResultProps interface",
      "Force expanded state when verboseMode is true",
      "Add useEffect to update expanded state when verboseMode changes",
      "Verify tool outputs expand when verbose mode is enabled",
      "Verify tool outputs collapse when verbose mode is disabled"
    ],
    "passes": true
  },
  {
    "category": "ui",
    "description": "Create format utilities for duration and timestamp display",
    "steps": [
      "Create new file src/ui/utils/format.ts",
      "Implement formatDuration function (ms < 1000 shows ms, < 60000 shows seconds, else minutes)",
      "Implement formatTimestamp function for HH:MM AM/PM format",
      "Export both functions",
      "Create tests/ui/utils/format.test.ts with edge case tests"
    ],
    "passes": true
  },
  {
    "category": "functional",
    "description": "Add timestamp tracking to messages",
    "steps": [
      "Enhance ChatMessage interface with durationMs, modelId, and streamingStartedAt fields",
      "Add streamingStartRef to track when streaming starts",
      "Set streamingStartRef.current = Date.now() in handleStreamStart",
      "Calculate duration in handleComplete using streamingStartRef",
      "Update message with durationMs and modelId when stream completes",
      "Reset streamingStartRef.current to null after calculation"
    ],
    "passes": true
  },
  {
    "category": "ui",
    "description": "Create TimestampDisplay component for right-aligned timestamp and model",
    "steps": [
      "Create new file src/ui/components/timestamp-display.tsx",
      "Define TimestampDisplayProps with timestamp, durationMs, and modelId",
      "Render right-aligned timestamp using formatTimestamp",
      "Render duration using formatDuration when available",
      "Render model name when available",
      "Export component from src/ui/components/index.ts",
      "Create unit tests for the component"
    ],
    "passes": false
  },
  {
    "category": "ui",
    "description": "Integrate TimestampDisplay into MessageBubble for verbose mode",
    "steps": [
      "Import TimestampDisplay in src/ui/chat.tsx MessageBubble component",
      "Add verboseMode prop to MessageBubble",
      "Conditionally render TimestampDisplay when verboseMode is enabled",
      "Display timestamp, duration, and model for assistant messages",
      "Test timestamp display appears only in verbose mode"
    ],
    "passes": false
  },
  {
    "category": "ui",
    "description": "Create FooterStatus component for status line",
    "steps": [
      "Create new file src/ui/components/footer-status.tsx",
      "Define FooterStatusProps with verboseMode, isStreaming, queuedCount, modelId",
      "Render permission mode indicator",
      "Render queued message count when > 0",
      "Render keyboard shortcut hints",
      "Export component from src/ui/components/index.ts",
      "Create unit tests for the component"
    ],
    "passes": false
  },
  {
    "category": "ui",
    "description": "Integrate FooterStatus into ChatApp layout",
    "steps": [
      "Import FooterStatus in src/ui/chat.tsx",
      "Add FooterStatus to ChatApp render at bottom of layout",
      "Pass verboseMode, isStreaming, queueCount, and modelId props",
      "Verify footer displays correctly in the UI",
      "Test footer updates when queue count changes"
    ],
    "passes": false
  },
  {
    "category": "ui",
    "description": "Define configurable array of spinner verbs for LoadingIndicator",
    "steps": [
      "Create SPINNER_VERBS constant array with verbs like Thinking, Analyzing, Processing",
      "Add at least 5-8 different verb options",
      "Ensure verbs are contextually appropriate for AI assistant actions"
    ],
    "passes": false
  },
  {
    "category": "ui",
    "description": "Enhance LoadingIndicator to display random spinner verb",
    "steps": [
      "Modify LoadingIndicator component in src/ui/chat.tsx",
      "Select random verb from SPINNER_VERBS array on mount",
      "Display verb text alongside the wave animation",
      "Format as 'Verb...' with ellipsis",
      "Verify verb changes between different loading instances"
    ],
    "passes": false
  },
  {
    "category": "refactor",
    "description": "Export new components and hooks from index files",
    "steps": [
      "Update or create src/ui/components/index.ts with exports for FooterStatus, TimestampDisplay, QueueIndicator",
      "Create src/ui/hooks/index.ts if it doesn't exist",
      "Export useMessageQueue from hooks index",
      "Verify all new modules are properly accessible"
    ],
    "passes": false
  },
  {
    "category": "functional",
    "description": "Add integration tests for message queuing flow",
    "steps": [
      "Add tests to tests/ui/chat.test.tsx for queue functionality",
      "Test submitting message during streaming adds to queue",
      "Test queue processes after stream completion",
      "Test multiple queued messages process sequentially",
      "Test queue indicator updates correctly"
    ],
    "passes": false
  },
  {
    "category": "functional",
    "description": "Add integration tests for verbose mode toggle",
    "steps": [
      "Add tests to tests/ui/chat.test.tsx for verbose mode",
      "Test Ctrl+O toggles verboseMode state",
      "Test tool outputs expand when verbose mode enabled",
      "Test timestamps appear when verbose mode enabled",
      "Test footer shows verbose mode indicator"
    ],
    "passes": false
  },
  {
    "category": "e2e",
    "description": "E2E test: Create dummy temp project with atomic init",
    "steps": [
      "Use tmux-cli skill to create a new tmux session for E2E testing",
      "Create a temporary directory for the test project (e.g., /tmp/atomic-e2e-test-XXXX)",
      "Navigate to the temp directory in the tmux pane",
      "Run 'atomic init' to initialize the project",
      "Verify initialization completes successfully by checking output",
      "Verify expected config files are created (.claude, .opencode, .github directories)",
      "Capture and log test results"
    ],
    "passes": false
  },
  {
    "category": "e2e",
    "description": "E2E test: Verify atomic chat with Claude agent (-a claude)",
    "steps": [
      "Use tmux-cli skill to communicate with test tmux session",
      "Navigate to the initialized temp project directory",
      "Run 'atomic chat -a claude' in the tmux pane",
      "Wait for chat UI to initialize and display",
      "Verify Claude agent header/branding appears in the UI",
      "Send a simple test message (e.g., 'Hello, respond with OK')",
      "Verify response is received from Claude agent",
      "Exit chat gracefully with Ctrl+C or /exit command",
      "Capture and log test results"
    ],
    "passes": false
  },
  {
    "category": "e2e",
    "description": "E2E test: Verify atomic chat with OpenCode agent (-a opencode)",
    "steps": [
      "Use tmux-cli skill to communicate with test tmux session",
      "Navigate to the initialized temp project directory",
      "Run 'atomic chat -a opencode' in the tmux pane",
      "Wait for chat UI to initialize and display",
      "Verify OpenCode agent header/branding appears in the UI",
      "Send a simple test message (e.g., 'Hello, respond with OK')",
      "Verify response is received from OpenCode agent",
      "Exit chat gracefully with Ctrl+C or /exit command",
      "Capture and log test results"
    ],
    "passes": false
  },
  {
    "category": "e2e",
    "description": "E2E test: Verify atomic chat with Copilot agent (-a copilot)",
    "steps": [
      "Use tmux-cli skill to communicate with test tmux session",
      "Navigate to the initialized temp project directory",
      "Run 'atomic chat -a copilot' in the tmux pane",
      "Wait for chat UI to initialize and display",
      "Verify Copilot agent header/branding appears in the UI",
      "Send a simple test message (e.g., 'Hello, respond with OK')",
      "Verify response is received from Copilot agent",
      "Exit chat gracefully with Ctrl+C or /exit command",
      "Capture and log test results"
    ],
    "passes": false
  },
  {
    "category": "e2e",
    "description": "E2E test: Verify message queuing during streaming for all agents",
    "steps": [
      "Use tmux-cli skill to communicate with test tmux session",
      "For each agent (claude, opencode, copilot):",
      "  - Start 'atomic chat -a <agent>'",
      "  - Send a message that triggers a long response",
      "  - While streaming, type and submit a second message",
      "  - Verify the second message is queued (queue indicator shows)",
      "  - Wait for first response to complete",
      "  - Verify queued message is processed automatically",
      "Exit and capture results for each agent"
    ],
    "passes": false
  },
  {
    "category": "e2e",
    "description": "E2E test: Verify verbose mode toggle (Ctrl+O) for all agents",
    "steps": [
      "Use tmux-cli skill to communicate with test tmux session",
      "For each agent (claude, opencode, copilot):",
      "  - Start 'atomic chat -a <agent>'",
      "  - Send a message that triggers tool usage",
      "  - Verify tool output is collapsed by default",
      "  - Press Ctrl+O to toggle verbose mode",
      "  - Verify tool output expands and timestamps appear",
      "  - Press Ctrl+O again to toggle off",
      "  - Verify tool output collapses",
      "Exit and capture results for each agent"
    ],
    "passes": false
  },
  {
    "category": "e2e",
    "description": "E2E test: Verify footer status displays correctly for all agents",
    "steps": [
      "Use tmux-cli skill to communicate with test tmux session",
      "For each agent (claude, opencode, copilot):",
      "  - Start 'atomic chat -a <agent>'",
      "  - Verify footer status line is visible at bottom",
      "  - Verify keyboard shortcut hints are displayed",
      "  - Toggle verbose mode and verify footer updates",
      "  - Queue a message and verify queue count appears in footer",
      "Exit and capture results for each agent"
    ],
    "passes": false
  },
  {
    "category": "e2e",
    "description": "E2E test: Cleanup temp project after all tests complete",
    "steps": [
      "Use tmux-cli skill to communicate with test tmux session",
      "Remove the temporary test project directory",
      "Kill the test tmux session",
      "Verify cleanup completed successfully",
      "Generate final E2E test report summarizing all pass/fail results"
    ],
    "passes": false
  }
]
