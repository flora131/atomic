[
  {
    "category": "functional",
    "description": "Message queuing - allow user input during streaming responses",
    "steps": [
      "Create useMessageQueue hook in src/ui/hooks/use-message-queue.ts with QueuedMessage interface",
      "Implement enqueue, dequeue, clear, and count methods in the hook",
      "Add messageQueue state to ChatApp component",
      "Remove isStreaming guard from handleSubmit function",
      "Queue messages when isStreaming is true instead of blocking",
      "Process queued messages sequentially in handleComplete after response completes",
      "Add visual indicator for queued messages (QueueIndicator component)",
      "Write unit tests for useMessageQueue hook",
      "Write integration tests for message queuing flow"
    ],
    "passes": true
  },
  {
    "category": "ui",
    "description": "Collapsible tool outputs - default to collapsed with summary line",
    "steps": [
      "Change ToolResult initialExpanded default from true to false",
      "Implement getToolSummary function to generate summary text for each tool type",
      "Add summary line display when collapsed showing tool name and result count",
      "Add maxCollapsedLines prop with default of 3",
      "Add showExpandHint prop with (ctrl+o to expand) hint text",
      "Update ToolResult to respect verboseMode prop for forced expansion",
      "Write unit tests for getToolSummary function",
      "Write component tests for collapsed/expanded states"
    ],
    "passes": true
  },
  {
    "category": "critical",
    "description": "Fix tool call display in chat UI - tool calls not showing during streaming",
    "steps": [
      "Add tool_use message type handling in handleStreamMessage in src/ui/index.ts",
      "Extract tool name, input, and ID from tool_use messages",
      "Pass tool events to ChatApp via callbacks or message content",
      "Display tool calls in MessageBubble with ToolResult component",
      "Ensure tool output is captured and displayed after tool execution",
      "Write integration tests for tool call display"
    ],
    "passes": true
  },
  {
    "category": "functional",
    "description": "Timing display - track and show message duration and timestamps",
    "steps": [
      "Create src/ui/utils/format.ts with formatDuration and formatTimestamp functions",
      "Add durationMs, modelId, and streamingStartedAt fields to ChatMessage interface",
      "Add streamingStartRef to track when streaming starts",
      "Record streamingStartedAt timestamp in handleStreamStart",
      "Calculate and store durationMs in handleComplete",
      "Create TimestampDisplay component in src/ui/components/timestamp-display.tsx",
      "Display timestamp and model name right-aligned when verbose mode is enabled",
      "Write unit tests for formatDuration and formatTimestamp utilities",
      "Write component tests for TimestampDisplay"
    ],
    "passes": true
  },
  {
    "category": "ui",
    "description": "Spinner verb customization - display random verbs during loading",
    "steps": [
      "Define array of spinner verbs (Thinking, Analyzing, Processing, etc.)",
      "Update LoadingIndicator component to accept verb prop",
      "Select random verb when loading starts",
      "Display verb text alongside loading animation",
      "Consider verb rotation during long operations",
      "Write component tests for LoadingIndicator with verbs"
    ],
    "passes": true
  },
    {
    "category": "ui",
    "description": "QueueIndicator component - visual display of queued messages",
    "steps": [
      "Create QueueIndicator component in src/ui/components/queue-indicator.tsx",
      "Accept queue array and display count",
      "Show queued message previews (truncated content)",
      "Style to differentiate from sent messages",
      "Export from src/ui/components/index.ts",
      "Write component tests for QueueIndicator"
    ],
    "passes": true
  },
  {
    "category": "refactor",
    "description": "Create hooks directory and export structure",
    "steps": [
      "Create src/ui/hooks directory if it doesn't exist",
      "Create src/ui/hooks/index.ts to export hooks",
      "Export useMessageQueue from hooks index",
      "Update any existing hook imports to use the new structure"
    ],
    "passes": true
  },
  {
    "category": "functional",
    "description": "InlineTool component - single-line display for read-only tools",
    "steps": [
      "Define INLINE_TOOLS constant array (Glob, Read, Grep, List, WebFetch, WebSearch)",
      "Create InlineTool component with icon, summary, and status",
      "Use accent color for active tools, muted for completed",
      "Show pending indicator for in-progress tools",
      "Integrate with ToolResult to use InlineTool when appropriate",
      "Write component tests for InlineTool"
    ],
    "passes": false
  },
  {
    "category": "functional",
    "description": "BlockTool component - bordered box display for mutating tools",
    "steps": [
      "Define BLOCK_TOOLS constant array (Bash, Write, Edit, Task, TodoWrite, Question)",
      "Create BlockTool component with bordered box, title, and collapsible content",
      "Add toggle indicator (▼/▶) for expand/collapse",
      "Support onClick handler for toggling",
      "Integrate with ToolResult to use BlockTool when appropriate",
      "Write component tests for BlockTool"
    ],
    "passes": false
  },
  {
    "category": "ui",
    "description": "Toast notification system for SDK errors",
    "steps": [
      "Create Toast interface with id, variant, message, duration fields",
      "Create ToastProvider context component",
      "Implement showToast callback with auto-dismiss timer",
      "Create ToastItem component for individual toast display",
      "Position toasts in top-right corner with absolute positioning",
      "Subscribe to client session.error events in ChatApp",
      "Display error toasts for SDK errors",
      "Write component tests for Toast system"
    ],
    "passes": false
  },
  {
    "category": "functional",
    "description": "SDK permission handler integration for Claude client",
    "steps": [
      "Add PermissionRequest hook to buildNativeHooks in claude-client.ts",
      "Emit permission.request event with toolUseID, toolName, toolInput, suggestions",
      "Implement waitForPermissionDecision method with abort support",
      "Return permissionDecision and permissionDecisionReason from hook",
      "Subscribe to permission.request events in ChatApp",
      "Show UserQuestionDialog for permission requests",
      "Write integration tests for permission flow"
    ],
    "passes": false
  },
  {
    "category": "functional",
    "description": "SDK permission handler integration for Copilot client",
    "steps": [
      "Call setPermissionHandler in createSession for copilot-client.ts",
      "Emit permission.request event with requestId, toolName, arguments",
      "Implement waitForPermissionDecision method",
      "Return approved or denied-interactively-by-user response",
      "Wire to ChatApp permission event subscription",
      "Write integration tests for Copilot permission flow"
    ],
    "passes": false
  },
  {
    "category": "functional",
    "description": "SDK permission handler integration for OpenCode client",
    "steps": [
      "Handle Permission field in SSE events in opencode-client.ts",
      "Surface permission events to UI layer",
      "Emit permission.request event with relevant data",
      "Wire to ChatApp permission event subscription",
      "Write integration tests for OpenCode permission flow"
    ],
    "passes": false
  }
]
